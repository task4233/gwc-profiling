/* カスタムスタイル - コードスニペットのダークモード対応 */

/* ダークモードでのコードブロック */
@media (prefers-color-scheme: dark) {
  .book-page {
    /* インラインコード */
    code {
      background-color: #3a3a3a !important;
      color: #e6e6e6 !important;
      border: 1px solid #555 !important;
      padding: 2px 6px !important;
      border-radius: 3px !important;
    }

    /* コードブロック */
    pre {
      background-color: #0d1117 !important;
      border: 1px solid #30363d !important;
      border-radius: 6px !important;

      code {
        background-color: transparent !important;
        border: none !important;
        color: #e6edf3 !important;
      }
    }

    /* シンタックスハイライト調整（GitHub Dark準拠） */
    .highlight {
      background-color: #0d1117 !important;

      pre {
        background-color: #0d1117 !important;
      }

      /* キーワード（func, var, const, if, for, etc.） */
      .k, .kd, .kn, .kp, .kr, .kt, .kc {
        color: #ff7b72 !important;
        font-weight: 500;
      }

      /* 文字列 */
      .s, .s1, .s2, .sb, .sc, .sd {
        color: #a5d6ff !important;
      }

      /* コメント */
      .c, .c1, .cm, .ch {
        color: #8b949e !important;
        font-style: italic;
      }

      /* 関数名 */
      .n, .nx, .nf, .fm {
        color: #d2a8ff !important;
      }

      /* 数値 */
      .m, .mi, .mf, .mh, .mb {
        color: #79c0ff !important;
      }

      /* 演算子 */
      .o, .ow {
        color: #ff7b72 !important;
      }

      /* 型（Go specific） */
      .kt, .nc {
        color: #ffa657 !important;
      }

      /* 変数 */
      .na, .nb, .bp {
        color: #79c0ff !important;
      }

      /* プロパティ・属性 */
      .py {
        color: #79c0ff !important;
      }

      /* 組み込み関数 */
      .nb {
        color: #d2a8ff !important;
      }

      /* パッケージ・インポート */
      .nn {
        color: #ffa657 !important;
      }

      /* エスケープシーケンス */
      .se {
        color: #79c0ff !important;
      }

      /* 正規表現 */
      .sr {
        color: #7ee787 !important;
      }

      /* デコレータ */
      .nd {
        color: #d2a8ff !important;
      }

      /* 句読点 */
      .p {
        color: #e6edf3 !important;
      }

      /* エラー・警告マーカー（❌ ✓など） */
      .err {
        color: #ff7b72 !important;
      }
    }

    /* テーブル内のコード */
    table {
      code {
        background-color: #3a3a3a !important;
        color: #e6e6e6 !important;
      }
    }

    /* 引用ブロック内のコード */
    blockquote {
      code {
        background-color: #3a3a3a !important;
        color: #e6e6e6 !important;
      }
    }
  }
}

/* ライトモードでのコードブロック（念のため明示） */
@media (prefers-color-scheme: light) {
  .book-page {
    code {
      background-color: #f5f5f5 !important;
      color: #333 !important;
      border: 1px solid #ddd !important;
      padding: 2px 6px !important;
      border-radius: 3px !important;
    }

    pre {
      background-color: #f8f8f8 !important;
      border: 1px solid #ddd !important;

      code {
        background-color: transparent !important;
        border: none !important;
        color: #333 !important;
      }
    }

    .highlight {
      background-color: #f8f8f8 !important;

      pre {
        background-color: #f8f8f8 !important;
      }
    }
  }
}

/* 共通スタイル（モードに関係なく適用） */
.book-page {
  /* コードブロックのフォント調整 */
  code, pre code {
    font-family: 'Menlo', 'Monaco', 'Courier New', monospace !important;
    font-size: 0.9em !important;
    line-height: 1.6 !important;
  }

  /* コードブロックの余白 */
  pre {
    padding: 16px !important;
    overflow-x: auto !important;
    margin: 1em 0 !important;
  }

  /* コマンドライン風のコードブロック */
  pre code.language-bash,
  pre code.language-shell,
  pre code.language-sh {
    &::before {
      content: '$ ';
      opacity: 0.5;
    }
  }
}

/* detailsタグ（ヒント・解答）のスタイル改善 */
@media (prefers-color-scheme: dark) {
  details {
    background-color: #2a2a2a !important;
    border: 1px solid #444 !important;
    border-radius: 4px !important;
    padding: 12px !important;
    margin: 1em 0 !important;

    summary {
      color: #569cd6 !important;
      font-weight: bold !important;
      cursor: pointer !important;
      user-select: none !important;

      &:hover {
        color: #7cb7ff !important;
      }
    }

    &[open] summary {
      margin-bottom: 8px !important;
      padding-bottom: 8px !important;
      border-bottom: 1px solid #444 !important;
    }
  }
}

@media (prefers-color-scheme: light) {
  details {
    background-color: #f9f9f9 !important;
    border: 1px solid #ddd !important;
    border-radius: 4px !important;
    padding: 12px !important;
    margin: 1em 0 !important;

    summary {
      color: #0066cc !important;
      font-weight: bold !important;
      cursor: pointer !important;
      user-select: none !important;

      &:hover {
        color: #0052a3 !important;
      }
    }

    &[open] summary {
      margin-bottom: 8px !important;
      padding-bottom: 8px !important;
      border-bottom: 1px solid #ddd !important;
    }
  }
}

/* テーブルのダークモード対応 */
@media (prefers-color-scheme: dark) {
  table {
    border-collapse: collapse !important;

    th {
      background-color: #2d2d2d !important;
      color: #f8f8f2 !important;
      border: 1px solid #444 !important;
    }

    td {
      border: 1px solid #444 !important;
      background-color: #1e1e1e !important;
      color: #d4d4d4 !important;
    }

    tr:hover td {
      background-color: #2a2a2a !important;
    }
  }
}
